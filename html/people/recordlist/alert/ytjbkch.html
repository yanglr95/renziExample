<div id="navbar-example1">
    <ul class="nav may_nav" role="tablist">
        <li><a href="#one">基本信息</a></li>
        <li><a href="#two">工作履历</a></li>
        <li><a href="#three">教育经历</a></li>
        <li><a href="#four">专家人才</a></li>
        <li><a href="#five">绩效信息</a></li>
    </ul>
    <div class="nav_xian">

    </div >
</div>
<div class="easyui-layout animated fadeInRight" data-options="fit:true" style="background: #fff;"
    style="width:100%;height: 100% ;overflow: auto;">


    <div data-options="region:'center',split:true" style="padding: 20px;position: relative;" class="per_west"
        data-spy="scroll" data-target="#navbar-example1">

        <div class="per_west_box" style="position: relative;">
            <div class="back" style="margin-bottom: 20px;">
                <div class="per-go-back">
                    <span></span>
                    <span>返回</span>
                </div>
            </div>
            <div class="per_btn_box" style="font-size: 16px;">
                <span>状态：</span><span class="detail-status">通过</span>
            </div>
            <div class="per-handle-btn" style="display: none;">
                <button class="primary-btn per-pass">通过</button>
                <button class="border-btn per-refuse">驳回</button>
            </div>
            <button class="primary-btn to-change-page" style="display: none;">变更</button>
            <!-- 审批弹窗 -->
            <div id="approve-box"></div>
            <div id="approve-box2"></div>
            <div class="top_box" style="font-size: 14px;">
                <div class="top_img" style="width: 60px;height: 60px;"><img src="assets/icon/ava.png" alt=""></div>
                <div class="top_con">
                    <div class="top_con_name" style="height: 30px;">
                        <span class="detail-num-title">申请单号：</span><b class="detail-num"></b>
                        <span>姓名：</span> <b class="name_top"></b>
                    </div>
                    <div class="top_con_list" style="height: 30px;">
                        <span>人员编码：</span><b class="p-num"></b>
                        <span>部门：</span><b class="detail-deptName"></b>
                        <span style="margin-left: 30px;">岗位：</span><b class="detail-postName"></b>
                    </div>
                </div>


            </div>
            <div class="per_main_list" id="one" style="font-size: 14px;">
                <div class="box-title">基本信息</div>
                <div class="per_main_con">
                    <div><span>姓别：</span> <b class="detail-gender"></b></div>
                    <div><span>年龄：</span> <b class="detail-birthDay"></b></div>
                    <div><span>民族：</span> <b class="detail-nationGroup"></b></div>
                    <div><span>政治面貌：</span> <b class="detail-partyStatus"></b></div>
                    <div><span>入职时间：</span> <b class="detail-dateVal"></b></div>
                    <div><span>职称：</span> <b class="detail-skillIdentGrade"></b></div>
                    <div><span>技能等级：</span> <b class="detail-qualificationLevel"></b></div>
                    <div><span>固定电话：</span> <b class="detail-contactCode"></b></div>
                </div>
            </div>
            <div class="per_main_list" id="two" style="font-size: 14px;">
                <div class="box-title">工作履历</div>
                <div class="per_cv_con" style="display: none;">
                    <div>
                        <span class="cv_time"><b class="cv_time_start">2008-12-20</b> ~ <b
                                class="cv_time_end">2009-12-30</b></span>
                        <!-- <b class="dian"></b> -->
                        <b class="dian">
                            <div class="xian"></div>
                        </b>
                        <b class="cv_name">太原供电公司变电检修工区</b>
                        <span class="cv_state">见习</span>
                        <span class="cv_department"></span>
                        <span class="cv_level"></span>
                    </div>
                </div>
                <div class="per_cv_con" style="display: none;">
                    <div>
                        <span class="cv_time"><b class="cv_time_start">2008-12-20</b> ~ <b
                                class="cv_time_end">2009-12-30</b></span>
                        <b class="dian"></b>
                        <b class="cv_name">太原供电公司变电检修工区</b>
                        <span class="cv_state">见习</span>
                        <span class="cv_department">科院</span>
                        <span class="cv_level">科长</span>
                    </div>
                </div>
                <div class="per_cv_con" style="display: none;">
                    <div>
                        <span class="cv_time"><b class="cv_time_start">2008-12-20</b> ~ <b
                                class="cv_time_end">2009-12-30</b></span>
                        <b class="dian"></b>
                        <b class="cv_name">太原供电公司变电检修工区</b>
                        <span class="cv_state">见习</span>
                        <span class="cv_department"></span>
                        <span class="cv_level"></span>
                    </div>
                </div>
            </div>
            <div class="per_main_list" id="three" style="font-size: 14px;">
                <div class="box-title">教育经历</div>
                <div class="per_cv_con" style="display: none;">
                    <div>
                        <span class="cv_time"><b class="cv_time_start">2008-12-20</b> ~ <b
                                class="cv_time_end">2009-12-30</b></span>
                        <b class="dian"></b>
                        <b class="cv_name">太原供电公司变电检修工区</b>
                        <span class="cv_state">见习</span>
                        <span class="cv_department"></span>
                        <span class="cv_level"></span>
                        <span class="is-top"></span>
                        <span class="cv_data material"><img src="assets/icon/field.png"> 证明材料</span>
                        <div class="detail-after-data" style="margin-top: 10px;">
                            <span>修改后：</span>
                            <span class="date-after"></span>
                            <!-- 学院 -->
                            <span class="eduOrgan-after"></span>
                            <!-- 学历 -->
                            <span class="education-after"></span>
                            <!-- 学位 -->
                            <span class="degree-after"></span>
                            <!-- 专业 -->
                            <span class="proressionName-after"></span>
                            <!-- 最高学历、学位 -->
                            <span class="is-top-both"></span>
                        </div>
                    </div>
                </div>
                <div class="per_cv_con" style="display: none;">
                    <div>
                        <span class="cv_time"><b class="cv_time_start">2008-12-20</b> ~ <b
                                class="cv_time_end">2009-12-30</b></span>
                        <b class="dian"></b>
                        <b class="cv_name">太原供电公司变电检修工区</b>
                        <span class="cv_state">见习</span>
                        <span class="cv_department"></span>
                        <span class="cv_level"></span>
                        <span class="is-top"></span>
                        <span class="cv_data material"><img src="assets/icon/field.png"> 证明材料</span>
                        <div class="detail-after-data" style="margin-top: 10px;">
                            <span>修改后：</span>
                            <span class="date-after"></span>
                            <!-- 学院 -->
                            <span class="eduOrgan-after"></span>
                            <!-- 学历 -->
                            <span class="education-after"></span>
                            <!-- 学位 -->
                            <span class="degree-after"></span>
                            <!-- 专业 -->
                            <span class="proressionName-after"></span>
                            <!-- 最高学历、学位 -->
                            <span class="is-top-both"></span>
                        </div>
                    </div>
                </div>
                <div class="per_cv_con" style="display: none;">
                    <div>
                        <span class="cv_time"><b class="cv_time_start">2008-12-20</b> ~ <b
                                class="cv_time_end">2009-12-30</b></span>
                        <b class="dian"></b>
                        <b class="cv_name">太原供电公司变电检修工区</b>
                        <span class="cv_state">见习</span>
                        <span class="cv_department"></span>
                        <span class="cv_level"></span>
                        <span class="is-top"></span>
                        <span class="cv_data material"><img src="assets/icon/field.png"> 证明材料</span>
                        <div class="detail-after-data" style="margin-top: 10px;">
                            <span>修改后：</span>
                            <span class="date-after"></span>
                            <!-- 学院 -->
                            <span class="eduOrgan-after"></span>
                            <!-- 学历 -->
                            <span class="education-after"></span>
                            <!-- 学位 -->
                            <span class="degree-after"></span>
                            <!-- 专业 -->
                            <span class="proressionName-after"></span>
                            <!-- 最高学历、学位 -->
                            <span class="is-top-both"></span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="per_main_list" id="four" style="font-size: 14px;">
                <div class="box-title">专家人才</div>
                <div class="per_cv_con">
                    <div>
                        <span class="cv_time"><b class="cv_time_start">2008-12-20</b> ~ <b
                                class="cv_time_end">2009-12-30</b></span>
                        <b class="dian"></b>
                        <b class="cv_name">太原供电公司变电检修工区</b>
                        <span class="cv_state">见习</span>
                        <span class="cv_department">科院</span>
                        <span class="cv_level">科长</span>
                    </div>
                </div>
                <div class="per_cv_con" style="display: none;">
                    <div>
                        <span class="cv_time"><b class="cv_time_start">2008-12-20</b> ~ <b
                                class="cv_time_end">2009-12-30</b></span>
                        <b class="dian"></b>
                        <b class="cv_name">太原供电公司变电检修工区</b>
                        <span class="cv_state">见习</span>
                        <span class="cv_department">科院</span>
                        <span class="cv_level">科长</span>
                    </div>
                </div>
            </div>
            <div class="per_main_list" id="five">
                <div class="box-title">绩效信息</div>
                <div class="easyui-tabs content-tabs">
                    <div title="月度绩效"></div>
                    <div title="季度绩效"></div>
                    <div title="年度绩效"></div>
                </div>
                <div class="nian_box" style="padding: 10px 0;">
                    年份： <input class="easyui-datebox cv_time_end_edit" label=""
                        data-options="formatter:myformatter,parser:myparser" style="width:140px;height: 25px;">
                </div>
                <div style="height: 500px;">
                    <table id="peoplesDetail" class="easyui-datagrid" data-options="singleSelect:true,collapsible:true,"
                        style="border: 1px solid #eee;"></table>
                </div>
            </div>
        </div>

    </div>
</div>

<script type="text/javascript">
        var thisPageId = null;
        var approvalStatus = null;
    $(function () {
        console.log($('#mainTabs').tabs('options').id.status,'123456789')
        // var thisPageId = null;
        // var approvalStatus = null;
        $('.per-go-back').click(function(){
            if ($('#mainTabs').tabs('options').id.status == 3) {
                closetabTitle('申请详情');
                opentab("people/peoples", "信息核对", false)
            }else if ($('#mainTabs').tabs('options').id.status == 0) {
                closetabTitle('申请详情');
                opentab("people/recordlist", "申请记录", false)
            }else if ($('#mainTabs').tabs('options').id.status == 1) {
                closetabTitle('申请详情');
                opentab("people/approval", "信息审批", false)
            }
        })
        if ($('#mainTabs').tabs('options').id.status == 1) {
            // console.log($('#mainTabs').tabs('options').id,'status')
            $('.per-handle-btn').show();
            $('.per_btn_box').hide();
            pageAjax()
        } else if ($('#mainTabs').tabs('options').id.status == 3) {
            $('.to-change-page').show();
            $('.per_btn_box').hide();
            $('.detail-num-title').hide();
            $('.detail-num').hide();
            $.ajax({
                type: 'get',
                url: BASE_URL + '/hrEmp/toUpdateEmp',
                data: {
                    empId: $('#mainTabs').tabs('options').id.id
                },
                success: function (data) {
                    // console.log(data, '----详情')
                    if (data.resultCode == 200) {
                        detailPageInfo(data.resultValue);
                        $('.to-change-page').click(function(){
                            closetabTitle("申请详情");
                            opentab("people/peoplesDetail", "申请详情", false,$('#mainTabs').tabs('options').id.id);
                        })
                    }
                }
            })
        }else{
            pageAjax()
        }
        //审批
        //通过
        $('.per-pass').click(function () {
            approvalStatus = 1;
            showPanalAlert(400, 350, '#approve-box', '通过', 'html/people/recordlist/alert/approval.html');
        })
        //驳回
        $('.per-refuse').click(function () {
            approvalStatus = 0;
            showPanalAlert(400, 350, '#approve-box2', '驳回', 'html/people/recordlist/alert/approval.html');
        })
        function pageAjax(){
            $.ajax({
                type: 'get',
                url: BASE_URL + '/hrEmp/loadEmpCheckInfo',
                data: {
                    recordId: $('#mainTabs').tabs('options').id.id
                },
                success: function (data) {
                    // console.log(data, '----详情')
                    if (data.resultCode == 200) {
                        thisPageId = data.resultValue.recordId;
                        detailPageInfo(data.resultValue)
                    }
                }
            })
        }
        function detailPageInfo(d) {
            $('.detail-status').text(d.status);
            $('.detail-num').text(d.orderNum);
            $('.name_top').text(d.chnName);
            $('.p-num').text(d.empId);
            $('.detail-deptName').text(d.deptName);
            $('.detail-postName').text(d.postName ? d.postName : '');
            //
            $('.detail-gender').text(d.gender);
            $('.detail-birthDay').text(ageSwitch(d.birthDay));
            $('.detail-nationGroup').text(d.nationGroup);
            $('.detail-partyStatus').text(d.partyStatus);
            $('.detail-dateVal').text(timeType(d.dateVal));
            $('.detail-skillIdentGrade').text(d.qualificationLevel);
            $('.detail-qualificationLevel').text(d.skillIdentGrade);
            $('.detail-contactCode').text(d.contactCode);
            //
            if (d.workList.length<=1) {
                $('.dian').eq(0).children('.xian').hide()
            }
            for (var i = 0; i < d.workList.length; i++) {
                $('#two .per_cv_con').eq(i).show()
                    .find('.cv_time_start').eq(i).text(timeType(d.workList[i].beginDate));
                $('#two .cv_time_end').eq(i).text(timeType(d.workList[i].endDate));
                $('#two .cv_name').eq(i).text(d.workList[i].unitName);
                $('#two .cv_state').eq(i).text(d.workList[i].deptName);
                $('#two .cv_department').eq(i).text(d.workList[i].duty ? d.workList[i].duty : '');
            }
            //学历
            // console.log(d.eduList)
            for (var i = 0; i < d.eduList.length; i++) {
                $('#three .per_cv_con').eq(i).show()
                    .find('.cv_time_start').eq(i).text(timeType(d.eduList[i].beginDat));//开始时间
                $('#three .cv_time_end').eq(i).text(timeType(d.eduList[i].endDate));//结束时间
                $('#three .cv_name').eq(i).text(d.eduList[i].eduOrgan + '(' + d.eduList[i].educationType + ')');//学院名称
                $('#three .cv_state').eq(i).text(d.eduList[i].education);//学历
                $('#three .cv_department').eq(i).text(d.eduList[i].degree ? d.eduList[i].degree : '');//学位
                $('#three .cv_level').eq(i).text(d.eduList[i].proressionName);//专业
                if(d.eduList[i].majorDegreeFlag=='1' && d.eduList[i].majorEducationFlag=='1'){ //是否最高学历、学位
                    $('.is-top').eq(i).text('最高学历、学位')
                }
                if (!d.eduList[i].beginDateAfter) {
                    $('#three .detail-after-data').eq(i).hide()
                }
                //修改后
                if (d.eduList[i].beginDateAfter!=d.eduList[i].beginDate || d.eduList[i].endDateAfter!=d.eduList[i].endDate) {
                    $('#three .date-after').eq(i).text(d.eduList[i].beginDateAfter+' ~ '+d.eduList[i].endDateAfter);
                }
                if (d.eduList[i].eduOrgan!=d.eduList[i].eduOrganAfter || d.eduList[i].educationType!=d.eduList[i].educationTypeAfter) {
                    $('#three .eduOrgan-after').eq(i).text(d.eduList[i].eduOrganAfter + '(' + d.eduList[i].educationTypeAfter + ')')
                }
                if (d.eduList[i].education!=d.eduList[i].educationAfter) {
                    $('#three .education-after').eq(i).text(d.eduList[i].educationAfter);
                }
                if (d.eduList[i].degree!=d.eduList[i].degreeAfter) {
                    $('#three .degree-after').eq(i).text(d.eduList[i].degreeAfter)
                }
                if (d.eduList[i].proressionName!=d.eduList[i].proressionNameAfter) {
                    $('#three .proressionName-after').eq(i).text(d.eduList[i].proressionNameAfter)
                }
                if ((d.eduList[i].majorDegreeFlag!=d.eduList[i].majorDegreeFlagAfter||d.eduList[i].majorEducationFlagAfter!=d.eduList[i].majorEducationFlag)&&(d.eduList[i].majorDegreeFlagAfter=='1'&&d.eduList[i].majorEducationFlagAfter=='1')) {
                    $('#three .is-top-both').eq(i).text('最高学历、学位');
                }
            }
        }


        var data = [
            {
                num: '20190382',
                name: '月度',
                date: '2019年11月',
                total: '130,000,000',
                endTime: '2019.06.03',
                state: '无',
                cfdate: '2019.06.03',
                fhdate: '2019.06.03',
                ccdate: '2019.06.03',
                reason: '无',
                adress: '详情',
                file: '无'
            },
        ]
        $('#peoplesDetail').datagrid({
            height: 360,
            width: '100%',
            fitColumns: true,
            //pagination: true,
            striped: true,
            data,
            columns: [[{ field: 'cfdate', title: '出发日期', halign: 'center', align: 'center' },
            { field: 'fhdate', title: '返回日期', halign: 'center', align: 'center' },
            { field: 'ccdate', title: '出差时长（天）', halign: 'center', align: 'center' },
            { field: 'reason', title: '事由', halign: 'center', align: 'center' },
            {
                field: 'adress', title: '行程', halign: 'center', align: 'center', formatter(value, row, index) {
                    return "90"
                }
            }
            ]]
        });
        $(".cv_data").on("click", function () {
            $(".imageGallery_box").show()
        })
        $('.per_west').scrollspy({ target: '#navbar-example1' })
    });
</script>