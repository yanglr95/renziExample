<div class="easyui-layout animated fadeInRight" data-options="fit:true" style="background: #edf1f2;">
    <div class="easyui-layout" style="width:100%;height: 100%">

        <div data-options="region:'center'" style="padding: 20px;position: relative;">

            <div class="shared_box" style="position: relative;">
                <div class="btnAdd" style="margin: 20px 0;overflow: hidden;">
                    
                </div>
                <div style="border-bottom: 1px solid #eee;">
                    <div class="box-title dtt">
                        红山县公司挂职锻炼申请（国网层级）
                    </div>
                    <div style="padding: 10px 0;">
                        <span>配置单号：<i class="pzdsp_pzdh">2103090876382277</i></span>
                        <span style="margin-left:120px;">报名有效期：<i class="pzdsp_bmyxq">2019-04-01-2019-06-01</i></span style="border-bottom: 1px solid #eee;">
                    </div>
                </div>

                <div style="overflow: hidden;width: calc(100% - 200px);" class="isShow">
                    <div style="width:100px;float: left ;height: 100%;">
                        <div>
                            <ul class="left_nav cddh">
                                <!-- <li class="act">干部管理</li>
                                <li>环保管理</li> -->
                            </ul>
                        </div>
                    </div>
                    <div class="lf" style="width:calc(100% - 100px);">
                        <div class="shared_main_list">
                            <div class="shared_main_title">基本信息</div>
                            <div class="shared_list jbxx">
                                <div><span>配置形式: </span><b class="a_1">1</b></div>
                                <div><span>岗位名称: </span><b class="a_2">2</b></div>
                                <div><span>试用期间: </span><b class="a_3">3</b></div>
                                <div><span>部门/处室: </span><b class="a_4">4</b></div>
                                <div><span>需求人数: </span><b class="a_5">5</b></div>
                                <div><span></span><b></b></div>
                                <div><span>所学专业: </span><b class="a_6">6</b></div>
                                <div><span>学历: </span><b class="a_7">6</b></div>
                                <div><span>任职年限: </span><b class="a_8">6</b></div>
                            </div>
                        </div>
                        <div class="shared_main_list">
                            <div class="shared_main_title" style="margin-bottom: 10px;">专业技术资格</div>
                            <div class="shared_list pzdsp_zyjszg">
                                <!-- <div><span>资格等级: </span><b class="b_1">1</b></div>
                                <div><span>资格要求: </span><b class="b_2">2</b></div> -->
                            </div>
                        </div>
                        <div class="shared_main_list">
                            <div class="shared_main_title" style="margin-bottom: 10px;">职业（执业）资格</div>
                            <div class="shared_list pzdsp_zyzg">
                                <!-- <div><span>资格要求: </span><b class="c_1">1</b></div>
                                <div><span>资格等级: </span><b class="c_2">2</b></div> -->
                            </div>
                        </div>
                        <div class="shared_main_list">
                            <div class="shared_main_title" style="margin-bottom: 10px;">岗位职责</div>
                            <div class="shared_list">
                                <p class="d_1">1.1 导入与部门工作相关的法律法规及相关要求，并负责向有关单位及人员宣贯；</p>
                                <!-- <p>1.2 按照体系要求开展部门的相关工作，确保体系的有效运行；</p>
                                <p>1.3 负责公司的质量或环境管理方针及目标/指标在部门内的宣贯、执行及监控；</p>
                                <p>1.4 负责编制部门职责范围内的操作规范文件与表单，依规实施并妥善保管相关文件与运行记录、表单；</p> -->
                            </div>
                        </div>
                        <div class="shared_main_list">
                            <div class="shared_main_title" style="margin-bottom: 10px;">职责条件</div>
                            <div class="shared_list">
                                <p class="e_1">1.1 导入与部门工作相关的法律法规及相关要求，并负责向有关单位及人员宣贯；</p>
                                <!-- <p>1.2 按照体系要求开展部门的相关工作，确保体系的有效运行；</p>
                                <p>1.3 负责公司的质量或环境管理方针及目标/指标在部门内的宣贯、执行及监控；</p>
                                <p>1.4 负责编制部门职责范围内的操作规范文件与表单，依规实施并妥善保管相关文件与运行记录、表单；</p> -->
                            </div>
                        </div>
                        <div class="shared_main_list">
                            <div class="shared_main_title" style="margin-bottom: 10px;">备注</div>
                            <div class="shared_list">
                                <p class="f_1">无</p>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

        </div>
    </div>
    <div data-options="region:'east'" style="width:200px; padding: 10px;">
        <div class="east_box">
            <div class="east_title">审核进度</div>
            <ul class="progress_ul">
                <li>
                    <div class="li_img_list"><img src="/assets/home/icon_quan_ok.png" alt=""> 提交申请</div>
                    <div class="li_time">
                        <span>李二胡</span>
                        <p>2019-10-10</p>
                    </div>
                </li>
                <li>
                    <div class="li_img_list"><img src="/assets/home/icon_quan_x.png" alt=""> 人资审核</div>
                    <div class="li_time">
                        <span class="progress_x">张一户</span>
                        <p>2019-10-10</p>
                    </div>
                </li>
                <li>
                    <div class="li_img_list"><img src="/assets/home/icon_quan_lg.png" alt=""> 重新提交</div>
                    <div class="li_time">
                        <span class="progress_x">张一户</span>
                        <p>2019-10-10</p>
                    </div>
                </li>
                <li>
                    <div class="li_img_list"><img style=" width: 15px;margin-left: 8px;margin-right: 2px;"
                            src="/assets/home/icon_quan_sm.png" alt=""> 完成</div>
                </li>
                <li class="xian_li">
                    <div class="xian"></div>
                </li>
            </ul>
        </div>
    </div>
</div>
</div>

<script type="text/javascript">
    var dataId=$("#mainTabs").tabs("options").id;//传参
    //var dataId=parameter.id;
    var dataIds=[dataId];
    console.log(dataIds)
    
    var dataCerter=null;
    StaffingInfo(dataId);
        
    function StaffingInfo(dataId){
        $.ajax({
            type:'GET',
            url:BASE_URL3+'/competitionApply/queryStaffingInfo',
            contentType:'application/json',
            data:{
                staffingId:dataId
                //staffingId:'6001'
            },
            success:function(data){
                console.log(data);
                if(data.resultValue!=null){
                    setpzdspDetaiTitle(data.resultValue.empStaffing);//设置头部数据
                    dataCerter=data.resultValue.compeListVOs;
                    setpzdspDetaiContent(dataCerter);//左侧菜单                       
                    if(dataCerter.length<=0){
                        $(".isShow").hide();
                    }
                    setpzdspDetaiContentCenter(0);
                };
            }
        })
    }
    //设置头部数据
    function setpzdspDetaiTitle(rows){
        $(".dtt").text(rows.staffingName);//配置单名称
        $(".pzdsp_pzdh").text(rows.staffingId);//配置单单号
        $(".pzdsp_bmyxq").text(timeType(rows.beginDate)+" - " + timeType(rows.endDate));//报名有效期

        var staffingStatus=rows.staffingStatus;//0401--待提交;0402--待审批;0403--已驳回;0404--已发布;0408--已作废；0409--资格审查
        console.log(staffingStatus);
        if(staffingStatus=="0402"){          
            $(".btnAdd").html('<button class="primary-btn" id="agreePzdsp">同意</button><button class="border-btn" id="disagreePzdsp">驳回</button>');
        }else{
            $(".btnAdd").html("");
        }
        var level = rows.publishLevel;//发布层级
        var levelName;
        if(level == "01"){
        		levelName = "本单位";
        }else if(level == "02"){
        		levelName = "地市公司级";
        }else if(level == "03"){
        		levelName = "省公司级";
        }else if(level == "04"){
        		levelName = "国网级";
        }
        var objects = rows.staffingId + " " + levelName; 
        //同意       
        $("#agreePzdsp").on("click",function(){           
            console.log(objects);
            agreeAlert(dataIds,objects,1,dataId);           
            function agreeAlert(ids,objs,pageN,id){
                mx.dataIds=ids;
                mx.objects=objs;
                mx.pageN=pageN;
                mx.dataId=id;
                showPanalAlert(480,380,'#agree','配置单审批同意','html/dispose/pzdspfile/pass.html');                
            }  
        });
        //驳回
        $("#disagreePzdsp").on("click",function(){ 
            disagreeSave(dataIds,objects,1,dataId);        
            function disagreeSave(ids,objs,pageN,id){
                mx.dataIds=ids;
                mx.objects=objs;
                mx.pageN=pageN;
                mx.dataId=id;
                showPanalAlert(480,380,'#refuse','配置单审批驳回','html/dispose/pzdspfile/cancel.html');               
            }                
        });        
    }
    //左侧菜单
    function setpzdspDetaiContent(rows){
        var cLi="";
        for(var i=0;i<rows.length;i++){
            cLi+="<li>"+rows[i].postCategoryName+"</li>";
        }      
        //$(cLi).appendTo($(".cddh"));
        $(".cddh").html(cLi);
        $(".cddh li").eq(0).addClass('act');
    }
    // setpzdspDetaiContentCenter(0)
    function setpzdspDetaiContentCenter(i){
        var zyjszg="";
        var zyzg="";
        $(".a_1").text(forShape(dataCerter[i].staffingMethod) || "--");//配置形式
        $(".a_2").text(formatString(dataCerter[i].postName,"--"));//岗位名称
        $(".a_3").text(formatString(timeType(dataCerter[i].beginDate),"--")+"至"+formatString(timeType(dataCerter[i].endDate),"--"));//试用期间
        $(".a_4").text(formatString(dataCerter[i].recruitDeptName,"--"));//部门/处室
        $(".a_5").text(formatString(dataCerter[i].recruitNumber,"--"));//需求人数
        $(".a_6").text(formatString(dataCerter[i].recruitProfession,"--"));//所学专业
        $(".a_7").text(dataCerter[i].educationName?dataCerter[i].educationName+"及以上" : "--");//学历
        $(".a_8").text(dataCerter[i].experienceYear?dataCerter[i].experienceYear+"年及以上" : "--");//任职年限
        for(var j =0;j<dataCerter[i].skill.length;j++){
            if(dataCerter[i].skill[j].abilityName && dataCerter[i].skill[j].abilityLevel){
                zyjszg+='<div style="width: 50%;"><span>资格要求: </span><b>'+dataCerter[i].skill[j].abilityName+'</b></div>';
                zyjszg+='<div style="width: 50%;"><span>资格等级: </span><b>'+forSkill(dataCerter[i].skill[j].abilityLevel)+'</b></div>';
            }

        }
        for(var j =0;j<dataCerter[i].qualification.length;j++){
            if(dataCerter[i].qualification[j].abilityName && dataCerter[i].qualification[j].abilityLevel){
                zyzg+='<div style="width: 50%;"><span>资格要求: </span><b>'+dataCerter[i].qualification[j].abilityName+'</b></div>';
                zyzg+='<div style="width: 50%;"><span>资格等级: </span><b>'+forQualifi(dataCerter[i].qualification[j].abilityLevel)+'</b></div>';
            }

        }
        $(".pzdsp_zyjszg").html(formatString(zyjszg,"--"));//专业技术资格
        $(".pzdsp_zyzg").html(formatString(zyzg,"--"));//职业（执业）资格
        $(".d_1").text(formatString(dataCerter[i].jobDesc,"无"));//岗位职责
        $(".e_1").text(formatString(dataCerter[i].competenceDesc,"无"));//职责条件
        $(".f_1").text(formatString(dataCerter[i].remark,"无"));//备注
    }

    //点击导航
    $(".cddh").on("click","li",function(){
        var index=$(this).index();
        $(this).addClass('act').siblings().removeClass('act');
        setpzdspDetaiContentCenter(index);
    }); 
    function forShape (val) {
	    	var lvStr="";
	    	if(val==="B122"){
	    		lvStr="岗位竞聘-转正";
	    	}else if(val==="B132"){
	    		lvStr="岗位竞聘-试用（工资、人事关系保留原单位)";
	    	}else if(val==="B134"){
	    		lvStr="岗位竞聘-试用(工资、人事关系调入原单位)";
	    	}
	    	return lvStr;
	}
	function forSkill(val){
		var lvStr ="";
		if(val==="1"){
			lvStr="高级技师";
		}else if(val==="2"){
			lvStr="技师";
		}else if(val==="3"){
			lvStr="高级工";
		}else if(val==="4"){
			lvStr="中级工";
		}else if(val==="5"){
			lvStr="初级工";
		}
		return lvStr;
	}
	function forQualifi(val){
		var lvStr ="";
		if(val==="1"){
			lvStr="正高级";
		}else if(val==="2"){
			lvStr="副高级";
		}else if(val==="3"){
			lvStr="中级";
		}else if(val==="4"){
			lvStr="初级";
		}
		return lvStr;
	}
   
</script>